<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.title}"></title>
</head>
<body>
<p>Название: <span th:text="${book.title}"></span></p>
<p>Автор: <span th:text="${book.author}"></span></p>

<h2>Книгу взяли:</h2>
<div th:each="person : ${peopleWithBook}">
    <span th:text="${person.fio}"></span>
    <form action="/books/{id}/return-book" method="post" style="display: inline;">
        <input type="hidden" th:name="personId" th:value="${person.id}"/>
        <button type="submit">Вернуть</button>
    </form>
</div>

<div th:if="${#lists.isEmpty(peopleWithBook)}">
    <p>Все книги в библиотеке</p>
</div>
<br>
<button onclick="document.getElementById('peopleSelection').style.display='block'">Выдать пользователю</button>

<div id="peopleSelection" style="display: none">
    <h3>Выдать книгу пользователю</h3>
    <form th:action="@{/books/{id}/assign-book(id=${book.id})}" method="post">
        <select name = "personId" required>
            <option value="">Выберите пользователя...</option>
            <option th:each="person : ${peopleWithoutBook}"
                    th:value="${person.id}"
                    th:text="${person.fio}">
            </option>
        </select>
        <button type="submit">Выдать</button>
        <button onclick="document.getElementById('peopleSelection').style.display = 'none'">Отмена</button>
    </form>
</div>

</body>
</html>